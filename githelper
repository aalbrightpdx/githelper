#!/usr/bin/env python3

import os
import subprocess
import sys

def run_cmd(cmd):
    result = subprocess.run(cmd, shell=True, text=True, capture_output=True)
    if result.stdout:
        print(result.stdout.strip())
    if result.stderr:
        print(result.stderr.strip())
    return result.returncode == 0

def in_git_repo():
    return subprocess.run("git rev-parse --is-inside-work-tree", shell=True,
                           stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL).returncode == 0

def main():
    if not in_git_repo():
        print("âŒ Not inside a git repository. Please 'cd' into one first.")
        sys.exit(1)

    print("\nğŸ” Checking git status...\n")
    if not run_cmd("git status"):
        print("Error running git status.")
        sys.exit(1)

    confirm = input("\nâœ… Does everything look correct? (y/n): ").strip().lower()
    if confirm != 'y':
        print("âŒ Aborted.")
        sys.exit(0)

    if not run_cmd("git add ."):
        print("âŒ Error running git add.")
        sys.exit(1)

    commit_msg = input("\nğŸ“ Enter your commit message: ").strip()
    if not commit_msg:
        print("âŒ Commit message cannot be empty.")
        sys.exit(1)

    if not run_cmd(f"git commit -m \"{commit_msg}\""):
        print("âŒ Error committing.")
        sys.exit(1)

    print("\nğŸ“œ Hereâ€™s the commit you just made:\n")
    run_cmd("git log -1 --stat")

    confirm_push = input("\nğŸš€ Ready to push to GitHub? (y/n): ").strip().lower()
    if confirm_push != 'y':
        print("âŒ Push canceled.")
        sys.exit(0)

    if not run_cmd("git push"):
        print("âŒ Error pushing to GitHub.")
        sys.exit(1)

    print("\nğŸ‰âœ… All done! Your changes are pushed!")

if __name__ == "__main__":
    main()

